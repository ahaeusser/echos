---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  dev = "svg",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# echos

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
<!-- badges: end -->

This package provides a tidy R interface for modeling and forecasting univariate time series using Echo State Networks (ESNs). The model works within the `fable` framework provided by the `fabletools` package, which provides the tools to evaluate, visualise, and combine models in a workflow consistent with the tidyverse.

## Installation

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("ahaeusser/echos")
```
## Usage

### Load packages
```{r packages, warning=FALSE, message=FALSE}
library(echos)
library(dplyr)
library(tsibble)
library(fabletools)
library(fable)
Sys.setlocale("LC_TIME", "C")
```

### Prepare data
```{r data}
n_train <- 130  # training window
n_ahead <- 12   # testing window (forecast horizon)

# Prepare data as tsibble
data <- AirPassengers %>%
  as_tsibble() %>%
  rename(
    Date = index,
    Passengers = value)

# Training data
data_train <- data %>%
  slice(1:n_train)

data_train

# Testing data
data_test <- data %>%
  slice((n_train + 1):(n_train + n_ahead))

data_test
```

### Model
```{r model}
# Train models
models <- data_train %>%
  model(
    esn = ESN(Passengers),
    arima = ARIMA(Passengers),
    ets = ETS(Passengers))

models

# Detailed report of ESN
models %>%
  select(esn) %>%
  report()

```

### Forecast
```{r forecast}
# Forecast models
fcsts <- models %>%
  forecast(h = n_ahead)

fcsts
```

### Visualize
```{r plot}
fcsts %>%
  autoplot(
    rbind(data_train, data_test),
    level = NULL,
    size = 1)
```


## Work in Progress

* Implement specials
  + `const()` - intercept term
  + `lags()` - autoregressive lags
  + `fourier()` - fourier terms (trigonometric terms) for seasonality
  + `xreg()` - exogenuous regressors
* Implement further functions
  + `refit.ESN()`
  + `generate.ESN()`
  + `stream.ESN()`
  + `reservoir.ESN()`
  + `plot_reservoir()`
  + ...
* Enhance `ESN()` to mulitvariate time series
